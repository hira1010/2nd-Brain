# AI Active Context & Rules

このファイルは、Antigravity（AIアシスタント）がこのプロジェクトで常に意識すべきローカルルールを記述します。

## 📅 定期実行ルール (Recurring Rules)

### 資産データの同期 (Asset Sync)

- **条件**: 偶数日（2日, 4日, 6日...）にAIが起動された場合
- **アクション**: `18_システム/sync_assets.py` を実行するか、ユーザーに同期を提案する
- **場所**: `07_株/配当金・資産推移.md`
- **目的**: スプレッドシートの資産状況を自動反映

**実行コマンド**:

```powershell
python "18_システム/sync_assets.py"
```

### ダイエット記録時のコーチング

- **条件**: `01_ダイエット/記録.md` に新しい日の記録を追加した場合
- **アクション**: 自動的に以下を実行
  1. **昨日の良かった点を分析**: 前日の数値・行動から成功要因を抽出
  2. **今日のアドバイス生成**: 継続するための具体的なアクション提案
  3. **チャット欄に出力**: ユーザーに直接フィードバック

**出力例**:

```
📊 2/5の記録を確認しました！

✅ 昨日の良かった点：
- 体脂肪率が28.5%→28.3%に改善（-0.2%）
- ウエスト測定を開始（117cm、今後の変化追跡に有効）

💡 今日のアドバイス：
- この調子で16時間断食を継続してください
- ウエストは週2回測定すると、内臓脂肪の変化が見えやすいです
- 水分補給を意識しましょう（1日2L目安）
```

---

## 🗂️ ファイル管理ルール

### ダイエット記録

- **メインファイル**: `01_ダイエット/記録.md`
- **形式**: タイムライン（各日をカード形式で縦配置）
- **統合**: 旧`04_日誌`の内容を含む
- **更新頻度**: 毎日
- **自動コーチング**: 記録追加時に昨日比較＆アドバイス生成

### 資産管理

- **メインファイル**: `07_株/配当金・資産推移.md`
- **データソース**: Googleスプレッドシート
- **更新**: 偶数日に自動提案（手動も可）

### HP作成

- **場所**: `14_HP作成スキル/`
- **ワークフロー**: Gemini → GitHub → Vercel
- **参照**: `README.md`, `deploy_helper.ps1`

---

## 🛠️ システム構成

### スクリプトの場所

- **同期エンジン**: `18_システム/sync_assets.py`
- **プロンプト生成**: `18_システム/refactor_prompts.py`
- **汎用リファクタ**: `18_システム/smart_refactor.py`

### 設定ファイル

- **AIルール**: `18_システム/Active_Context.md` (このファイル)
- **アーキテクチャ**: `18_システム/00_Architecture_Overview.md`
- **プロンプト集**: `18_システム/01_Prompts/`

---

## 🤖 AI行動指針

### コーディング規約

1. **型ヒント**: すべての関数に型を明記
2. **エラー処理**: `try-except` で適切に処理
3. **ログ**: 明確な進捗表示
4. **ドキュメント**: docstringで機能説明

**参考実装**: `sync_assets.py`

### ファイル編集時の注意

- テーブルフォーマット: パイプ `|` の前後に必ず空白
- Markdownリンク: 絶対パスを使用
- 日本語コメント: すべてのコードに日本語コメントを付与

### ダイエットコーチング時の分析ポイント

- **数値比較**: 体重、体脂肪率、内臓脂肪、骨格筋率の変化
- **トレンド**: 短期（前日比）と中期（週平均）
- **行動**: 日記から継続している良い習慣を特定
- **提案**: 具体的で実行可能なアクション（数値目標付き）

---

## 📊 プロジェクト統計

- **総フォルダ数**: 19
- **システムファイル数**: 69（18_システム/）
- **自動化スクリプト**: 3つ（Python）
- **Lintエラー**: 0

---

**最終更新**: 2026-02-05  
**バージョン**: 2.1（ダイエットコーチング機能追加）
